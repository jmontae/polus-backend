<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: crud/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: crud/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * module for the CRUD service
 * Create, Read, Update, Delete on the filesystem
 * @module crud
 */


const { fs, path } = require('../../.helper'),
basedir = path.join(__dirname, '/../../old')

module.exports = {
	//create a file
	create: async ( filename, route, data ) => {
		return new Promise( ( rsl, rej ) => {
			//try to open the file
			fs.open( `${basedir}${route}/${filename}.json`, 'wx', ( err, filedesc ) => {
				if( !err &amp;&amp; filedesc ) {
					let string_data = JSON.stringify(data)
					fs.writeFile( filedesc, string_data, (err) => {
						if(!err) { 
							fs.close( filedesc, (err) => {
								if(!err) {
									rsl(true);
								} else { rej( new Error('error closing new file') ) }
							})
						} else { rej( new Error('error writing to new file') ) }
					})
				} else { 
					rej( new Error( err ) )  }
			})
		})
	},

	read: async ( file ) => {
		return new Promise( ( rsl, rej ) => {
			fs.readFile( file, 'utf-8', ( err, data ) => {
				if(err) { 
					console.log('no file found.')
					rej(err) 
				} else { rsl(data) }
			})
		})
	}

	// update: async ( basedir, dir, file, data) => {
	// 	return new Promise( ( rsl, rej ) => {
	// 		//open the file
	// 		fs.open( `${basedir}${dir}/${file}.json`, 'r+', ( err, filedesc ) => {
	// 			if(!err &amp;&amp; filedesc) {
	// 				let string_data = JSON.stringify(data)

	// 				fs.ftruncate( filedesc, (err) => {
	// 					if(!err) {
	// 						fs.writeFile( filedesc, string_data, (err) => {
	// 							if(!err) {
	// 								fs.close( filedesc, (err) => {
	// 									if(!err) { rsl(true) }
	// 										else { rej( new Error( 'error closing existing file' ) ) }
	// 								})
	// 							} else { rej( new Error( 'error writing to existing file' ) ) }
	// 						})
	// 					} else { rej( new Error( 'error truncating existing file' ) ) }
	// 				})
	// 			} else { rej( new Error( 'error opening file. may not exist' ) ) }
	// 		})
	// 	})
	// },

	// delete: async ( basedir, dir, file ) => {
	// 	return new Promise( ( rsl, rej) => {
	// 		fs.unlink( basedir + dir + '/' + file + '.json', (err) => {
	// 			if(!err) { rsl(true) }
	// 				else { rej( new Error( 'error deleting file' ) ) }
	// 		})
	// 	})
	// }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-cherwell.html">cherwell</a></li><li><a href="module-cherwell_handler.html">cherwell/handler</a></li><li><a href="module-cherwell_object.html">cherwell/object</a></li><li><a href="module-crud.html">crud</a></li><li><a href="module-model.html">model</a></li><li><a href="module-model_dashboard.html">model/dashboard</a></li><li><a href="module-model_dashboard_default.html">model/dashboard/default</a></li><li><a href="module-model_form.html">model/form</a></li><li><a href="module-model_task.html">model/task</a></li><li><a href="module-model_ticket.html">model/ticket</a></li><li><a href="module-ui.html">ui</a></li><li><a href="module-ui_dashboard.html">ui/dashboard</a></li></ul><h3>Global</h3><ul><li><a href="global.html#expect">expect</a></li><li><a href="global.html#it">it</a></li><li><a href="global.html#test">test</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu Oct 15 2020 10:09:40 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
