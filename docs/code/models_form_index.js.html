<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models/form/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models/form/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Form model
 * a form is used to collect information from a user.
 * @module model/form
 * @requires module:helper.glob
 * @requires module:helper.path
 * @requires module:helper.colors
 * @requires module:crud
 */

const { glob, path, colors } = require('../../../.helper'),
crud = require('../../crud'),
forms = {
   defaults: []
}

let _form = ( forms ) => ({
   forms,

   get( tenant, { service, category, subcategory } ) {
      try {
			if(typeof( this.forms[tenant] ) == 'object') {
				//check and see if there's a form
				let form = this.forms[tenant][service].find(form => (form.category == category &amp;&amp; form.subcategory == subcategory));
				//if there is, run the callback with the form
				if(form) {
					return form
            } else {
               //if there isn't, return a default form after checking the catalog entry

            }
            
            return null 
         }		
		} catch(error) {
			console.log('there was an error:\n', error);
			return error
		}
   }
})

/**
 * @function init
 * @summary intializes the form model, gathering the available forms
 * @return {closure} closure fuction holding the forms and getter
 */
module.exports = () =>  {
   console.log('\n[boot/lib/models] gathering forms...'.yellow)
   let files = glob.sync('./.data/forms/**/**.json')
   files.forEach( file => {
		//read the file
      crud.read( file ).then( form => {
         form = JSON.parse( form )
         
         //check for default forms
         if( form.name.includes('Default') ) {
            //add them to forms object
            forms.defaults.push(form);
            console.log(`[boot/lib/models] -->> form added to defaults: ${form.name}`.green);
   
         } else {
            
            if( !forms.hasOwnProperty(form.tenant) ) {
               forms[form.tenant] = { [form.service]: new Array() }
            }
            else if( !forms[form.tenant].hasOwnProperty(form.service) ) {
               forms[form.tenant][form.service] = new Array()
            }
   
            forms[form.tenant][form.service].push( form );
            console.log(`[boot/lib/models] -->> form added to ${form.tenant}/${form.service}: ${form.name} (${form.category} > ${form.subcategory})`.green);
         }
      })
   })

   return _form( forms )
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-cherwell.html">cherwell</a></li><li><a href="module-cherwell_handler.html">cherwell/handler</a></li><li><a href="module-cherwell_object.html">cherwell/object</a></li><li><a href="module-crud.html">crud</a></li><li><a href="module-model.html">model</a></li><li><a href="module-model_dashboard.html">model/dashboard</a></li><li><a href="module-model_dashboard_default.html">model/dashboard/default</a></li><li><a href="module-model_form.html">model/form</a></li><li><a href="module-model_task.html">model/task</a></li><li><a href="module-model_ticket.html">model/ticket</a></li><li><a href="module-ui.html">ui</a></li><li><a href="module-ui_dashboard.html">ui/dashboard</a></li></ul><h3>Global</h3><ul><li><a href="global.html#expect">expect</a></li><li><a href="global.html#it">it</a></li><li><a href="global.html#test">test</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu Oct 15 2020 10:09:40 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
